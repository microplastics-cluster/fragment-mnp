
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plotting &#8212; FRAGMENT-MNP</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced usage" href="advanced-usage.html" />
    <link rel="prev" title="Fragmentation and dissolution rates" href="fragmentation-dissolution-rates.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FRAGMENT-MNP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   FRAGMENT-MNP
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Users
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="example-usage.html">
   Example usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="config.html">
   Model configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input-data.html">
   Input data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fragmentation-dissolution-rates.html">
   Fragmentation and dissolution rates
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Plotting
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="advanced-usage.html">
   Advanced usage
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-usage/fragment-size-distribution.html">
     Fragment size distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-usage/numerical-instability.html">
     Dealing with numerical instability
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developers
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="developers/quickstart.html">
   Developers quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developers/conda.html">
   Developing with Conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developers/api.html">
   API Reference
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/plotting.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/microplastics-cluster/fragment-mnp"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/microplastics-cluster/fragment-mnp/issues/new?title=Issue%20on%20page%20%2Fplotting.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/microplastics-cluster/fragment-mnp/main?urlpath=tree/docs/plotting.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-types-dissolution-and-log-scales">
   Plot types, dissolution and log scales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#units">
   Units
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#legends-and-colourmaps">
   Legends and colourmaps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selecting-which-size-classes-to-plot">
   Selecting which size classes to plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-control-through-matplotlib">
   Advanced control through matplotlib
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Plotting</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-types-dissolution-and-log-scales">
   Plot types, dissolution and log scales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#units">
   Units
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#legends-and-colourmaps">
   Legends and colourmaps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selecting-which-size-classes-to-plot">
   Selecting which size classes to plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-control-through-matplotlib">
   Advanced control through matplotlib
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="plotting">
<h1>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h1>
<p>The model output offers a simple plotting function to make it easy to quickly visualise your simulations. See the <a class="reference external" href="./developers/api.html#fragmentmnp.output.FMNPOutput.plot">API reference</a> for full details.</p>
<p>To plot the time evolution of mass concentrations across size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fragmentmnp</span> <span class="kn">import</span> <span class="n">FragmentMNP</span>
<span class="kn">from</span> <span class="nn">fragmentmnp.examples</span> <span class="kn">import</span> <span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span>

<span class="c1"># Use the example config and data to run the model</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Plot the results. `plot` returns (fig, ax), but we</span>
<span class="c1"># don&#39;t need that here</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_1_0.png" src="_images/plotting_1_0.png" />
</div>
</div>
<div class="section" id="plot-types-dissolution-and-log-scales">
<h2>Plot types, dissolution and log scales<a class="headerlink" href="#plot-types-dissolution-and-log-scales" title="Permalink to this headline">¶</a></h2>
<p>You can either plot mass concentrations (<code class="docutils literal notranslate"><span class="pre">mass_conc</span></code>) or particle number concentrations (<code class="docutils literal notranslate"><span class="pre">particle_number_conc</span></code>) by using the <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter. The default is to plot mass concentrations (as per above). Dissolution mass concentrations can be included on a secondary y axis by specifying <code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code>. In the following example, we specify an arbitrary dissolution rate to demonstrate this.</p>
<p>By default, the y-axis scale is linear. A log scale can be used instead by specifying <code class="docutils literal notranslate"><span class="pre">log_yaxis=True</span></code> or <code class="docutils literal notranslate"><span class="pre">log_yaxis='log'</span></code>, or a <a class="reference external" href="https://matplotlib.org/stable/gallery/scales/symlog_demo.html">symlog</a> scale can be used by specifying <code class="docutils literal notranslate"><span class="pre">log_yaxis='symlog'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make dissolution happen and re-run the model</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_diss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Plot the particle number concentration</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;particle_number_conc&#39;</span><span class="p">,</span>
                <span class="n">plot_dissolution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">log_yaxis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_3_0.png" src="_images/plotting_3_0.png" />
</div>
</div>
</div>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>The model itself is, by design, unit-agnostic. Because of this, if you want units on your axes and legend, they must be specified by using the <code class="docutils literal notranslate"><span class="pre">units</span></code> parameter. This can either be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SI</span></code>: Use SI units (kg, m, s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code>: Use dimension names (“mass”, “length”, “time”, “volume”) instead of units.</p></li>
<li><p>A dictionary that maps between dimension and units, e.g. <code class="docutils literal notranslate"><span class="pre">{'mass':</span> <span class="pre">'mg',</span> <span class="pre">'length':</span> <span class="pre">'µm',</span> <span class="pre">'time':</span> <span class="pre">'days',</span> <span class="pre">'volume':</span> <span class="pre">'l'}</span></code>. All four elements - mass, length, time and volume - must be present.</p></li>
</ul>
<p>If no <code class="docutils literal notranslate"><span class="pre">units</span></code> parameter is provided (or it is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>), no units are shown on labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use SI units on the labels</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;si&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_5_0.png" src="_images/plotting_5_0.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Specifying units to use on a plot does <em>not</em> alter the model output data in any way. Remember, the model is unit-agnostic. It is up to you to verify that the units that you specify are correct (i.e. match the input data you provided). If you wish to scale the output data before plotting, you can do this directly on the <code class="docutils literal notranslate"><span class="pre">FMNPOutput</span></code> object.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale the particle sizes from m to µm before plotting</span>
<span class="n">output</span><span class="o">.</span><span class="n">psd</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">psd</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="c1"># Keep all the other units the same, just modify the length</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;µm&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">:</span> <span class="s1">&#39;m3&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_7_0.png" src="_images/plotting_7_0.png" />
</div>
</div>
</div>
<div class="section" id="legends-and-colourmaps">
<h2>Legends and colourmaps<a class="headerlink" href="#legends-and-colourmaps" title="Permalink to this headline">¶</a></h2>
<p>By default, the size class legend is shown. This can be toggled off with <code class="docutils literal notranslate"><span class="pre">show_legend=False</span></code>. Note that, if the dissolution axis is shown (<code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code>), the dissolution legend is always shown in order to distinguish it from the particle concentrations. If you wish to change this, you can <a class="reference internal" href="#plotting-fig-ax"><span class="std std-ref">access the underlying matplotlib fig and axes to do so</span></a>.</p>
<p>You can also control the colourmap that is used by specifying the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> option to be one of the <a class="reference external" href="https://matplotlib.org/stable/gallery/color/colormap_reference.html">options provided by matplotlib</a>. The default is “viridis”, which is a good colourblind-friendly option for sequential data (i.e. particle size classes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t show the legend and use the rainbow cmap (really?!)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_9_0.png" src="_images/plotting_9_0.png" />
</div>
</div>
</div>
<div class="section" id="selecting-which-size-classes-to-plot">
<h2>Selecting which size classes to plot<a class="headerlink" href="#selecting-which-size-classes-to-plot" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> parameter lets you choose which size classes you want to plot. This might be useful if you are plotting the model output data against measurement data that is binned with a coarser size resolution, and you only wish to plot size classes for which there are measurement data. The <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> parameter takes a list of size class indices, with 0 representing the smallest size class. Setting <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code> will result in all size classes being plotted, which is the default.</p>
<p>For example, to plot only the smallest and largest size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size_classes_to_plot</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">n_size_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_11_0.png" src="_images/plotting_11_0.png" />
</div>
</div>
</div>
<div class="section" id="advanced-control-through-matplotlib">
<span id="plotting-fig-ax"></span><h2>Advanced control through matplotlib<a class="headerlink" href="#advanced-control-through-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>If the simple options provided directly by the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function don’t meet your requirements, the underlying matplotlib <code class="docutils literal notranslate"><span class="pre">fig</span></code> and <code class="docutils literal notranslate"><span class="pre">ax</span></code> objects are returned from the function. For example, to change an axis label to a custom value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Duration&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_13_0.png" src="_images/plotting_13_0.png" />
</div>
</div>
<p>Note that, if <code class="docutils literal notranslate"><span class="pre">plot_dissolution=False</span></code> (default), then only one axis is created and returned by the function. If <code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code>, two axes are created and these are returned in a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_dissolution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># The zeroth axis is the main particle concentration axis</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Particle mass concentration&#39;</span><span class="p">)</span>
<span class="c1"># The first axis is the dissolution axis</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Discorporated polymer&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Discorporated&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="c1"># Save the figure to a file</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pretty-graph.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plotting_15_0.png" src="_images/plotting_15_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="fragmentation-dissolution-rates.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Fragmentation and dissolution rates</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="advanced-usage.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced usage</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Sam Harrison<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>