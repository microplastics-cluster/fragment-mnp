

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plotting &#8212; FRAGMENT-MNP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'plotting';</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fragmentation, dissolution and mineralisation rates" href="fragmentation-dissolution-rates.html" />
    <link rel="prev" title="Input data" href="input-data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="FRAGMENT-MNP - Home"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="FRAGMENT-MNP - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    FRAGMENT-MNP
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="example-usage.html">Example usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Model configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-data.html">Input data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="fragmentation-dissolution-rates.html">Fragmentation, dissolution and mineralisation rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="dissolution-mineralisation.html">Dissolution and mineralisation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced-usage.html">Advanced usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-usage/fragment-size-distribution.html">Fragment size distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-usage/numerical-instability.html">Dealing with numerical instability</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="developers/quickstart.html">Developers quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers/conda.html">Developing with Conda/Mamba</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers/docs.html">Writing documentation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api/model.html">FRAGMENT-MNP model</a></li>

<li class="toctree-l1"><a class="reference internal" href="api/examples.html">Example config and data (<code class="xref py py-mod docutils literal notranslate"><span class="pre">fragmentmnp.examples</span></code>)</a></li>




<li class="toctree-l1"><a class="reference internal" href="api/output.html">FRAGMENT-MNP output</a></li>

<li class="toctree-l1"><a class="reference internal" href="api/validation.html">Validation of config and data (<code class="xref py py-mod docutils literal notranslate"><span class="pre">fragmentmnp.validation</span></code>)</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/microplastics-cluster/fragment-mnp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/microplastics-cluster/fragment-mnp/issues/new?title=Issue%20on%20page%20%2Fplotting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/plotting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Plotting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-types-dissolution-mineralisation-and-log-scales">Plot types, dissolution/mineralisation and log scales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#units">Units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legends-and-colourmaps">Legends and colourmaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-which-size-classes-to-plot">Selecting which size classes to plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-control-through-matplotlib">Advanced control through matplotlib</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="plotting">
<h1>Plotting<a class="headerlink" href="#plotting" title="Permalink to this heading">#</a></h1>
<p>The model output offers a simple plotting function to make it easy to quickly visualise your simulations. See <a class="reference internal" href="api/output.html#fragmentmnp.output.FMNPOutput.plot" title="fragmentmnp.output.FMNPOutput.plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">FMNPOutput.plot()</span></code></a> for full details.</p>
<p>To plot the time evolution of mass concentrations across size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fragmentmnp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FragmentMNP</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fragmentmnp.examples</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span>

<span class="c1"># Use the example config and data to run the model</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Plot the results. `plot` returns (fig, ax), but we</span>
<span class="c1"># don&#39;t need that here</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d5065d1f3e987adbc0294a7ad97548652ca78e2c03f684968bf4f960cb8e4800.png" src="_images/d5065d1f3e987adbc0294a7ad97548652ca78e2c03f684968bf4f960cb8e4800.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are running the model via a script, rather than an interactive environment (e.g. Jupyter), you can pass <code class="docutils literal notranslate"><span class="pre">show=True</span></code> to the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function in order to automatically display the plot, i.e. <code class="docutils literal notranslate"><span class="pre">output.plot(show=True)</span></code>. <code class="docutils literal notranslate"><span class="pre">show</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default so as not to inhibit users from <a class="reference internal" href="#plotting-fig-ax"><span class="std std-ref">building more complex plots</span></a> by returning <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span></code> and using these.</p>
</div>
<div class="section" id="plot-types-dissolution-mineralisation-and-log-scales">
<h2>Plot types, dissolution/mineralisation and log scales<a class="headerlink" href="#plot-types-dissolution-mineralisation-and-log-scales" title="Permalink to this heading">#</a></h2>
<p>You can either plot mass concentrations (<code class="docutils literal notranslate"><span class="pre">mass_conc</span></code>) or particle number concentrations (<code class="docutils literal notranslate"><span class="pre">particle_number_conc</span></code>) by using the <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter. The default is to plot mass concentrations (as per above). Dissolution and mineralisation mass concentrations can be included on a secondary y axis by specifying <code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code> and/or <code class="docutils literal notranslate"><span class="pre">plot_mineralisation=True</span></code>. In the following example, we specify an arbitrary dissolution rate to demonstrate this.</p>
<p>By default, the y-axis scale is linear. A log scale can be used instead by specifying <code class="docutils literal notranslate"><span class="pre">log_yaxis=True</span></code> or <code class="docutils literal notranslate"><span class="pre">log_yaxis='log'</span></code>, or a <a class="reference external" href="https://matplotlib.org/stable/gallery/scales/symlog_demo.html">symlog</a> scale can be used by specifying <code class="docutils literal notranslate"><span class="pre">log_yaxis='symlog'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make dissolution happen and re-run the model</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_diss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># Plot the particle number concentration</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;particle_number_conc&#39;</span><span class="p">,</span>
                <span class="n">plot_dissolution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">log_yaxis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b80bb22cf05934d796ab6ca40f3e7b228be63129f618296e8d243114dacf0b82.png" src="_images/b80bb22cf05934d796ab6ca40f3e7b228be63129f618296e8d243114dacf0b82.png" />
</div>
</div>
</div>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this heading">#</a></h2>
<p>The model itself is, by design, unit-agnostic. Because of this, if you want units on your axes and legend, they must be specified by using the <code class="docutils literal notranslate"><span class="pre">units</span></code> parameter. This can either be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SI</span></code>: Use SI units (kg, m, s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code>: Use dimension names (“mass”, “length”, “time”, “volume”) instead of units.</p></li>
<li><p>A dictionary that maps between dimension and units, e.g. <code class="docutils literal notranslate"><span class="pre">{'mass':</span> <span class="pre">'mg',</span> <span class="pre">'length':</span> <span class="pre">'µm',</span> <span class="pre">'time':</span> <span class="pre">'days',</span> <span class="pre">'volume':</span> <span class="pre">'l'}</span></code>. All four elements - mass, length, time and volume - must be present.</p></li>
</ul>
<p>If no <code class="docutils literal notranslate"><span class="pre">units</span></code> parameter is provided (or it is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>), no units are shown on labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use SI units on the labels</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;si&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/33df8ed7b9c39572d84e264fb5f91ef6a4da56c5f61a30101bb82c49fef9400d.png" src="_images/33df8ed7b9c39572d84e264fb5f91ef6a4da56c5f61a30101bb82c49fef9400d.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Specifying units to use on a plot does <em>not</em> alter the model output data in any way. Remember, the model is unit-agnostic. It is up to you to verify that the units that you specify are correct (i.e. match the input data you provided). If you wish to scale the output data before plotting, you can do this directly on the <code class="docutils literal notranslate"><span class="pre">FMNPOutput</span></code> object.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale the particle sizes from m to µm before plotting</span>
<span class="n">output</span><span class="o">.</span><span class="n">psd</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">psd</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="c1"># Keep all the other units the same, just modify the length</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;µm&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">:</span> <span class="s1">&#39;m3&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2db43dd79dcdd6e526d9e805429bba8a8ab678102877c7ea9decd14de1737828.png" src="_images/2db43dd79dcdd6e526d9e805429bba8a8ab678102877c7ea9decd14de1737828.png" />
</div>
</div>
</div>
<div class="section" id="legends-and-colourmaps">
<h2>Legends and colourmaps<a class="headerlink" href="#legends-and-colourmaps" title="Permalink to this heading">#</a></h2>
<p>By default, the size class legend is shown. This can be toggled off with <code class="docutils literal notranslate"><span class="pre">show_legend=False</span></code>. Note that, if the dissolution axis is shown (<code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code>), the dissolution legend is always shown in order to distinguish it from the particle concentrations. If you wish to change this, you can <a class="reference internal" href="#plotting-fig-ax"><span class="std std-ref">access the underlying matplotlib fig and axes to do so</span></a>.</p>
<p>You can also control the colourmap that is used by specifying the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> option to be one of the <a class="reference external" href="https://matplotlib.org/stable/gallery/color/colormap_reference.html">options provided by matplotlib</a>. The default is “viridis”, which is a good colourblind-friendly option for sequential data (i.e. particle size classes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t show the legend and use the rainbow cmap (really?!)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0183a73aa8e3cc5706d9c6f59aabefda2c6882b24c138c4e0d1628706b884560.png" src="_images/0183a73aa8e3cc5706d9c6f59aabefda2c6882b24c138c4e0d1628706b884560.png" />
</div>
</div>
</div>
<div class="section" id="selecting-which-size-classes-to-plot">
<h2>Selecting which size classes to plot<a class="headerlink" href="#selecting-which-size-classes-to-plot" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> parameter lets you choose which size classes you want to plot. This might be useful if you are plotting the model output data against measurement data that is binned with a coarser size resolution, and you only wish to plot size classes for which there are measurement data. The <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> parameter takes a list of size class indices, with 0 representing the smallest size class. Setting <code class="docutils literal notranslate"><span class="pre">size_classes_to_plot</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code> will result in all size classes being plotted, which is the default.</p>
<p>For example, to plot only the smallest and largest size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size_classes_to_plot</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">n_size_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8e9194a6225f8f24f2ae4bbcaafdd85e2f890ca4614e6753efe00719fd90611.png" src="_images/b8e9194a6225f8f24f2ae4bbcaafdd85e2f890ca4614e6753efe00719fd90611.png" />
</div>
</div>
</div>
<div class="section" id="advanced-control-through-matplotlib">
<span id="plotting-fig-ax"></span><h2>Advanced control through matplotlib<a class="headerlink" href="#advanced-control-through-matplotlib" title="Permalink to this heading">#</a></h2>
<p>If the simple options provided directly by the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function don’t meet your requirements, the underlying matplotlib <code class="docutils literal notranslate"><span class="pre">fig</span></code> and <code class="docutils literal notranslate"><span class="pre">ax</span></code> objects are returned from the function. For example, to change an axis label to a custom value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Duration&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/968eecc3765e4eb2260f172ec92de15551e06f5fad66827d644a17b231ac9dcd.png" src="_images/968eecc3765e4eb2260f172ec92de15551e06f5fad66827d644a17b231ac9dcd.png" />
</div>
</div>
<p>Note that, if <code class="docutils literal notranslate"><span class="pre">plot_dissolution=False</span></code> (default), then only one axis is created and returned by the function. If <code class="docutils literal notranslate"><span class="pre">plot_dissolution=True</span></code>, two axes are created and these are returned in a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_dissolution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># The zeroth axis is the main particle concentration axis</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Particle mass concentration&#39;</span><span class="p">)</span>
<span class="c1"># The first axis is the dissolution axis</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Discorporated polymer&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Discorporated&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="c1"># Save the figure to a file</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;pretty-graph.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c0438c6816e15eff704c5b5b6b8dae6e10ce32b7a94a9fe6d1d30695efead6f1.png" src="_images/c0438c6816e15eff704c5b5b6b8dae6e10ce32b7a94a9fe6d1d30695efead6f1.png" />
</div>
</div>
<p>If you set the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> parameter <code class="docutils literal notranslate"><span class="pre">show=True</span></code>, <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> will be called by the model and subsequent modifications to the fig and/or axes will not be displayed on the plotted figure.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="input-data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Input data</p>
      </div>
    </a>
    <a class="right-next"
       href="fragmentation-dissolution-rates.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fragmentation, dissolution and mineralisation rates</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-types-dissolution-mineralisation-and-log-scales">Plot types, dissolution/mineralisation and log scales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#units">Units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legends-and-colourmaps">Legends and colourmaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-which-size-classes-to-plot">Selecting which size classes to plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-control-through-matplotlib">Advanced control through matplotlib</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By UKCEH
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div style="position: relative">
  <a href="https://www.ceh.ac.uk/privacy-notice" target="_blank">Privacy notice</a>
  <img src="_static/ukceh.png" width=200 style="position: absolute; right: 0; bottom: 0;">
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>