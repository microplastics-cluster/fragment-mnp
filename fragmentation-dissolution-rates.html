
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fragmentation and dissolution rates &#8212; FRAGMENT-MNP</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plotting" href="plotting.html" />
    <link rel="prev" title="Input data" href="input-data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FRAGMENT-MNP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   FRAGMENT-MNP
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Users
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="example-usage.html">
   Example usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="config.html">
   Model configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input-data.html">
   Input data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Fragmentation and dissolution rates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="advanced-usage.html">
   Advanced usage
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-usage/fragment-size-distribution.html">
     Fragment size distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-usage/numerical-instability.html">
     Dealing with numerical instability
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developers
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="developers/quickstart.html">
   Developers quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developers/conda.html">
   Developing with Conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developers/api.html">
   API Reference
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/fragmentation-dissolution-rates.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/microplastics-cluster/fragment-mnp"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/microplastics-cluster/fragment-mnp/issues/new?title=Issue%20on%20page%20%2Ffragmentation-dissolution-rates.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/microplastics-cluster/fragment-mnp/main?urlpath=tree/docs/fragmentation-dissolution-rates.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-parameters">
   Regression parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   Examples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-your-own-k-text-frag-array">
   Setting your own
   <span class="math notranslate nohighlight">
    \(k_\text{frag}\)
   </span>
   array
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Fragmentation and dissolution rates</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-parameters">
   Regression parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   Examples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-your-own-k-text-frag-array">
   Setting your own
   <span class="math notranslate nohighlight">
    \(k_\text{frag}\)
   </span>
   array
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="fragmentation-and-dissolution-rates">
<h1>Fragmentation and dissolution rates<a class="headerlink" href="#fragmentation-and-dissolution-rates" title="Permalink to this headline">¶</a></h1>
<p>Fragmentation rate <span class="math notranslate nohighlight">\(k_\text{frag}\)</span> and dissolution rate <span class="math notranslate nohighlight">\(k_\text{diss}\)</span> control the rate at which polymer mass is lost from particle size classes, either to smaller size classes (fragmentation) or dissolved organics (dissolution). They have units of inverse time (s<sup>-1</sup> in SI units) and thus, for a given period of time <span class="math notranslate nohighlight">\(t + \Delta t\)</span>, a mass <span class="math notranslate nohighlight">\(m = \Delta t k_{i,t}\)</span> of polymer fragments or dissolves from size class <span class="math notranslate nohighlight">\(i\)</span>. The <a class="reference internal" href="advanced-usage/fragment-size-distribution.html"><span class="doc std std-doc">Fragment size distribution</span></a> controls how this mass is split amongst daughter size classes.</p>
<p>Both rate constants can vary in time and across particle surface areas, and thus they are 2D arrays with dimensions <code class="docutils literal notranslate"><span class="pre">(n_timesteps,</span> <span class="pre">n_size_classes)</span></code>. This dependence is controlled by the parameters provided in <a class="reference internal" href="input-data.html"><span class="doc std std-doc">model input data</span></a>, specifically to the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> and <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> variables. If scalars are provided to these, the rates are constant in time and surface area, and if a dict of regression parameters is provided, the rate constants vary in time and surface area according to these parameters, as detailed here.</p>
<p>The rate constant distributions are built using either a compound relationship:</p>
<div class="math notranslate nohighlight">
\[
k(t,s) = k_f T(t) S(s) + k_0
\]</div>
<p>or an additive relationship:</p>
<div class="math notranslate nohighlight">
\[
k(t,s) = k_f (T(t) + S(s)) + k_0
\]</div>
<p>You can specify which is used by specifying the boolean <code class="docutils literal notranslate"><span class="pre">is_compound</span></code> in the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> or <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> input data dict. Here, <code class="docutils literal notranslate"><span class="pre">t</span></code> is the time dimension, <code class="docutils literal notranslate"><span class="pre">s</span></code> is the particle surface area dimension, <code class="docutils literal notranslate"><span class="pre">k_f</span></code> is the rate constant scaling factor, <code class="docutils literal notranslate"><span class="pre">k_0</span></code> is the rate constant baseline adjustment factor and <code class="docutils literal notranslate"><span class="pre">k</span></code> could be <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> or <code class="docutils literal notranslate"><span class="pre">k_diss</span></code>. <code class="docutils literal notranslate"><span class="pre">T(t)</span></code> is the expression used to create the time-dependence distribution, and <code class="docutils literal notranslate"><span class="pre">S(s)</span></code> the surface area distribution. Both of these take the same form, which allows for power law, exponential, logarithmic and logistic regressions:</p>
<div class="math notranslate nohighlight">
\[
X(x) = A_x \hat{x}^{\alpha_x} \cdot B_x e^{-\beta_x \hat{x}}
       \cdot C_x \ln (\gamma_x \hat{x}) \cdot
       \frac{D_x}{1 + e^{-\delta_{x,1}(\hat{x} - \delta_{x,2})}}
\]</div>
<p>or if the user specifies a list for parameter <span class="math notranslate nohighlight">\(A_x\)</span>, a polynomial instead of power law can be used:</p>
<div class="math notranslate nohighlight">
\[
X(x) = \sum_{n=1}^N A_{x,n} \hat{x}^n \cdot B_x e^{-\beta_x \hat{x}} \cdot
       C_x \ln (\gamma_x \hat{x}) \cdot \frac{D_x}{1 + e^{-\delta_{x,1}(\hat{x}
       - \delta_{x,2})}}
\]</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">X(x)</span></code> is either <code class="docutils literal notranslate"><span class="pre">T(t)</span></code> or <code class="docutils literal notranslate"><span class="pre">S(s)</span></code>. The parameters <code class="docutils literal notranslate"><span class="pre">A_t</span></code>, <code class="docutils literal notranslate"><span class="pre">A_s</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha_t</span></code> etc are the parameters provided to the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> and <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> dicts in the input data. The dimension value <span class="math notranslate nohighlight">\(\hat{x}\)</span> is normalised such that the median value is equal to 1: <span class="math notranslate nohighlight">\(\hat{x} = x/\tilde{x}\)</span>, where <span class="math notranslate nohighlight">\(\tilde{x}\)</span> is the median of <span class="math notranslate nohighlight">\(x\)</span>. This ensures regressions are not skewed by <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> values that are many orders of magnitude apart.</p>
<div class="note admonition">
<p class="admonition-title">Smallest size class</p>
<p>The model presumes that <em>no</em> fragmentation happens from the smallest size class, and so <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> is always set to 0 for this size class. This is in constast to dissolution, which can happen from this size class.</p>
</div>
<div class="section" id="regression-parameters">
<h2>Regression parameters<a class="headerlink" href="#regression-parameters" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table" id="k-regression-params">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type, default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">k_f</span></code></p></td>
<td><p>Float, required</p></td>
<td><p>Rate constant scaling factor</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">k_0</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>Rate constant baseline adjustment factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A_t</span></code>, <code class="docutils literal notranslate"><span class="pre">A_s</span></code></p></td>
<td><p>Float or list, default=1</p></td>
<td><p>Power law coefficient. If a scalar is provided, this is used as the coefficient for a power law expression with <code class="docutils literal notranslate"><span class="pre">alpha_x</span></code> as the exponent. If a list is provided, these are used as coefficients in a polynomial expression, where the order of the polynomial is given by the length of the list. For example, if a length-2 list <code class="docutils literal notranslate"><span class="pre">A_t=[2,</span> <span class="pre">3]</span></code> is given, then the resulting polynomial will be <code class="docutils literal notranslate"><span class="pre">3*t**2</span> <span class="pre">+</span> <span class="pre">2*t</span></code> (note the list is in <em>ascending</em> order of polynomials).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">alpha_t</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha_s</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">A_x</span></code> is a scalar, <code class="docutils literal notranslate"><span class="pre">alpha_x</span></code> is the exponent for this power law expression. For example, if <code class="docutils literal notranslate"><span class="pre">A_t=2</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha_t=0.5</span></code>, the resulting power law will be <code class="docutils literal notranslate"><span class="pre">2*t**0.5</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B_t</span></code>, <code class="docutils literal notranslate"><span class="pre">B_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Exponential coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">beta_t</span></code>, <code class="docutils literal notranslate"><span class="pre">beta_s</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>Exponential scaling factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">C_t</span></code>, <code class="docutils literal notranslate"><span class="pre">C_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>If a scalar is given, this is the coefficient for the natural logarithmic term. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the logarithmic term is set to 1 (i.e. it is ignored).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gamma_t</span></code>, <code class="docutils literal notranslate"><span class="pre">gamma_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Logarithmic scaling factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">D_t</span></code>, <code class="docutils literal notranslate"><span class="pre">D_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>If a scalar is given, this is the coefficient for the logistic term. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the logistic term is set to 1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta1_t</span></code>, <code class="docutils literal notranslate"><span class="pre">delta1_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Logistic growth rate (steepness of the logistic term)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta2_t</span></code>, <code class="docutils literal notranslate"><span class="pre">delta2_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>Midpoint of the logistic curve, which denotes the <code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">s</span></code> value where the logistic curve is at its midpoint. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the midpoint is assumed to be the at the midpoint of the <code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">s</span></code> range. For example, if the model timesteps go from 1 to 100, then the default for <code class="docutils literal notranslate"><span class="pre">delta2_t</span></code> is 50.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">is_compound</span></code></p></td>
<td><p>Bool, default=True</p></td>
<td><p>Whether the <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> regression terms should be combined by multiplying them together (compound) or adding them. Choice depends on whether you think the time- and size-dependence of rate constants affect each other or act independently.</p></td>
</tr>
</tbody>
</table>
<div class="warning admonition">
<p class="admonition-title">Negative k values</p>
<p>Make sure to specify regression parameters that do not end up in negative <code class="docutils literal notranslate"><span class="pre">k</span></code> values. The model checks for these before running and will throw a <code class="docutils literal notranslate"><span class="pre">FMNPDistributionValueError</span></code> exception if any are found.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The make this more understandable, here are some examples are how you might use these parameters in real life. The first thing to note is that, if you want a k distribution to follow one particular regression, such as logistic, then you only need to specify parameters for that regression and the defaults take care of making sure the other regressions are constant. Taking a logistic regression as an example for <code class="docutils literal notranslate"><span class="pre">k_frag</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">fragmentmnp</span> <span class="kn">import</span> <span class="n">FragmentMNP</span>
<span class="kn">from</span> <span class="nn">fragmentmnp.examples</span> <span class="kn">import</span> <span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span>

<span class="c1"># By specifying D_t=1, we are telling the model that we want a</span>
<span class="c1"># logistic regression over time for k_frag. delta1_t controls</span>
<span class="c1"># the steepness of the logistic</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;D_t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;delta1_t&#39;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>

<span class="c1"># Init the model with these data, which generates the k distributions</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>

<span class="c1"># Plot the k_frag distribution to check that it is logistic. We</span>
<span class="c1"># didn&#39;t specify any surface area dependence params and so we</span>
<span class="c1"># can pick any size class except the smallest (which always </span>
<span class="c1"># has k_frag=0)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;k_frag&#39;)
</pre></div>
</div>
<img alt="_images/fragmentation-dissolution-rates_1_1.png" src="_images/fragmentation-dissolution-rates_1_1.png" />
</div>
</div>
<p>In the above, we effectively specified that <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> should follow the regresion <span class="math notranslate nohighlight">\(k_\text{frag} = 0.01 / (1 + e^{-(\hat{t} - 1)})\)</span>. Let’s now introduce a linear surface area dependence. Because the particle size classes are log-spaced, we plot with a log yscale in order to see the fragmentation rates for the smaller size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify a logistic regression over t and linear over s</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;D_t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;delta1_t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;A_s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Init the model</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>

<span class="c1"># Plot k_frag for all size classes except the smallest</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s1">&lt;1g</span><span class="si">}</span><span class="s1"> µm&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fragmentation-dissolution-rates_3_0.png" src="_images/fragmentation-dissolution-rates_3_0.png" />
</div>
</div>
<p>We can double check that the surface area dependence is linear by plotting the surface area against <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> for one timestep:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">surface_areas</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;particle surface area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;k_frag&#39;)
</pre></div>
</div>
<img alt="_images/fragmentation-dissolution-rates_5_1.png" src="_images/fragmentation-dissolution-rates_5_1.png" />
</div>
</div>
<p>Combining regressions can make for some weird and wonderful distribution shapes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third-order polynomial combined with a logarithmic regression - why not!?</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;k_0&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;A_t&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;C_t&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="c1"># Create and plot</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;k_frag&#39;)
</pre></div>
</div>
<img alt="_images/fragmentation-dissolution-rates_7_1.png" src="_images/fragmentation-dissolution-rates_7_1.png" />
</div>
</div>
</div>
<div class="section" id="setting-your-own-k-text-frag-array">
<h2>Setting your own <span class="math notranslate nohighlight">\(k_\text{frag}\)</span> array<a class="headerlink" href="#setting-your-own-k-text-frag-array" title="Permalink to this headline">¶</a></h2>
<p>If the time and size dependencies that can be achieved using the regression parammeters above are not flexible enough for your scenario, you can of course set your own <span class="math notranslate nohighlight">\(k_\text{frag}\)</span> array by modifying the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> attribute directly after initialising the model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a random k_frag array (really?!)</span>
<span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">n_timesteps</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">n_size_classes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="input-data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Input data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plotting.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plotting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Sam Harrison<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>