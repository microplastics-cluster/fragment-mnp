

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fragmentation, dissolution and mineralisation rates &#8212; FRAGMENT-MNP</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fragmentation-dissolution-rates';</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dissolution and mineralisation" href="dissolution-mineralisation.html" />
    <link rel="prev" title="Plotting" href="plotting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="FRAGMENT-MNP - Home"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="FRAGMENT-MNP - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    FRAGMENT-MNP
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="example-usage.html">Example usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Model configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-data.html">Input data</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Fragmentation, dissolution and mineralisation rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="dissolution-mineralisation.html">Dissolution and mineralisation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced-usage.html">Advanced usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-usage/fragment-size-distribution.html">Fragment size distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-usage/numerical-instability.html">Dealing with numerical instability</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="developers/quickstart.html">Developers quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers/conda.html">Developing with Conda/Mamba</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers/docs.html">Writing documentation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api/model.html">FRAGMENT-MNP model</a></li>

<li class="toctree-l1"><a class="reference internal" href="api/examples.html">Example config and data (<code class="xref py py-mod docutils literal notranslate"><span class="pre">fragmentmnp.examples</span></code>)</a></li>




<li class="toctree-l1"><a class="reference internal" href="api/output.html">FRAGMENT-MNP output</a></li>

<li class="toctree-l1"><a class="reference internal" href="api/validation.html">Validation of config and data (<code class="xref py py-mod docutils literal notranslate"><span class="pre">fragmentmnp.validation</span></code>)</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/microplastics-cluster/fragment-mnp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/microplastics-cluster/fragment-mnp/issues/new?title=Issue%20on%20page%20%2Ffragmentation-dissolution-rates.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/fragmentation-dissolution-rates.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fragmentation, dissolution and mineralisation rates</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-parameters">Regression parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-your-own-rate-constant-regressions">Setting your own rate constant regressions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="fragmentation-dissolution-and-mineralisation-rates">
<h1>Fragmentation, dissolution and mineralisation rates<a class="headerlink" href="#fragmentation-dissolution-and-mineralisation-rates" title="Permalink to this heading">#</a></h1>
<p>Fragmentation rate <span class="math notranslate nohighlight">\(k_\text{frag}\)</span> and dissolution rate <span class="math notranslate nohighlight">\(k_\text{diss}\)</span> constants control the rate at which polymer mass is lost from particle size classes, either to smaller size classes (fragmentation) or dissolved organics (dissolution). The mineralisation rate constant <span class="math notranslate nohighlight">\(k_\text{min}\)</span> controls the rate at which dissolved organics are completely broken down into their mineral components, such as CO<sub>2</sub>. These rate constants have units of inverse time (s<sup>-1</sup> in SI units) and thus, for a given period of time <span class="math notranslate nohighlight">\(t + \Delta t\)</span>, a mass <span class="math notranslate nohighlight">\(m = \Delta t k_{t}\)</span> of polymer fragments, dissolves or mineralises from a given pool. For fragmentation, the <a class="reference internal" href="advanced-usage/fragment-size-distribution.html"><span class="std std-doc">Fragment size distribution</span></a> controls how this mass is split amongst daughter size classes. <a class="reference internal" href="dissolution-mineralisation.html"><span class="std std-doc">Dissolution and mineralisation</span></a> describes in more detail the relationship between dissolution and mineralisation.</p>
<p>Fragmentation and dissolution rate constants can vary in time and across particle surface areas, and thus they are 2D arrays with dimensions <code class="docutils literal notranslate"><span class="pre">(n_timesteps,</span> <span class="pre">n_size_classes)</span></code>. The mineralisation rate constant can vary in time, and is therefore a 1D array with dimensions <code class="docutils literal notranslate"><span class="pre">(n_timesteps)</span></code>. These dependencies are controlled by the parameters provided in <a class="reference internal" href="input-data.html"><span class="doc std std-doc">model input data</span></a>, specifically to the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code>, <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> and <code class="docutils literal notranslate"><span class="pre">k_min</span></code> variables. If scalars are provided to these, the rates are constant in time and surface area, and if a dict of regression parameters is provided, the rate constants vary in time and surface area (<code class="docutils literal notranslate"><span class="pre">k_frag</span></code> and <code class="docutils literal notranslate"><span class="pre">k_diss</span></code>), or just in time (<code class="docutils literal notranslate"><span class="pre">k_min</span></code>), according to these parameters, as detailed here.</p>
<p>The rate constant distributions are built using either a compound relationship:</p>
<div class="math notranslate nohighlight">
\[
k(t,s) = k_f T(t) S(s) + k_0
\]</div>
<p>or an additive relationship:</p>
<div class="math notranslate nohighlight">
\[
k(t,s) = k_f (T(t) + S(s)) + k_0
\]</div>
<p>You can specify which is used by specifying the boolean <code class="docutils literal notranslate"><span class="pre">is_compound</span></code> in the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> or <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> input data dict. Here, <code class="docutils literal notranslate"><span class="pre">t</span></code> is the time dimension, <code class="docutils literal notranslate"><span class="pre">s</span></code> is the particle surface area dimension, <code class="docutils literal notranslate"><span class="pre">k_f</span></code> is the rate constant scaling factor, <code class="docutils literal notranslate"><span class="pre">k_0</span></code> is the rate constant baseline adjustment factor and <code class="docutils literal notranslate"><span class="pre">k</span></code> could be <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> or <code class="docutils literal notranslate"><span class="pre">k_diss</span></code>. <code class="docutils literal notranslate"><span class="pre">T(t)</span></code> is the expression used to create the time-dependence distribution, and <code class="docutils literal notranslate"><span class="pre">S(s)</span></code> the surface area distribution. In the case of mineralisation, only <code class="docutils literal notranslate"><span class="pre">T(t)</span></code> is used. Both of these take the same form, which allows for power law, exponential, logarithmic and logistic regressions:</p>
<div class="math notranslate nohighlight">
\[
X(x) = A_x \hat{x}^{\alpha_x} \cdot B_x e^{-\beta_x \hat{x}}
       \cdot C_x \ln (\gamma_x \hat{x}) \cdot
       \frac{D_x}{1 + e^{-\delta_{x,1}(\hat{x} - \delta_{x,2})}}
\]</div>
<p>or if the user specifies a list for parameter <span class="math notranslate nohighlight">\(A_x\)</span>, a polynomial instead of power law can be used:</p>
<div class="math notranslate nohighlight">
\[
X(x) = \sum_{n=1}^N A_{x,n} \hat{x}^n \cdot B_x e^{-\beta_x \hat{x}} \cdot
       C_x \ln (\gamma_x \hat{x}) \cdot \frac{D_x}{1 + e^{-\delta_{x,1}(\hat{x}
       - \delta_{x,2})}}
\]</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">X(x)</span></code> is either <code class="docutils literal notranslate"><span class="pre">T(t)</span></code> or <code class="docutils literal notranslate"><span class="pre">S(s)</span></code>. The parameters <code class="docutils literal notranslate"><span class="pre">A_t</span></code>, <code class="docutils literal notranslate"><span class="pre">A_s</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha_t</span></code> etc are the parameters provided to the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code>, <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> and <code class="docutils literal notranslate"><span class="pre">k_min</span></code> dicts in the input data. The dimension value <span class="math notranslate nohighlight">\(\hat{x}\)</span> is normalised such that the median value is equal to 1: <span class="math notranslate nohighlight">\(\hat{x} = x/\tilde{x}\)</span>, where <span class="math notranslate nohighlight">\(\tilde{x}\)</span> is the median of <span class="math notranslate nohighlight">\(x\)</span>. This ensures regressions are not skewed by <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> values that are many orders of magnitude apart.</p>
<div class="note admonition">
<p class="admonition-title">Smallest size class</p>
<p>The model presumes that <em>no</em> fragmentation happens from the smallest size class, and so <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> is always set to 0 for this size class. This is in constast to dissolution, which can happen from this size class.</p>
</div>
<div class="section" id="regression-parameters">
<h2>Regression parameters<a class="headerlink" href="#regression-parameters" title="Permalink to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table" id="k-regression-params">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type, default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">k_f</span></code></p></td>
<td><p>Float, required</p></td>
<td><p>Rate constant scaling factor</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">k_0</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>Rate constant baseline adjustment factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A_t</span></code>, <code class="docutils literal notranslate"><span class="pre">A_s</span></code></p></td>
<td><p>Float or list, default=1</p></td>
<td><p>Power law coefficient. If a scalar is provided, this is used as the coefficient for a power law expression with <code class="docutils literal notranslate"><span class="pre">alpha_x</span></code> as the exponent. If a list is provided, these are used as coefficients in a polynomial expression, where the order of the polynomial is given by the length of the list. For example, if a length-2 list <code class="docutils literal notranslate"><span class="pre">A_t=[2,</span> <span class="pre">3]</span></code> is given, then the resulting polynomial will be <code class="docutils literal notranslate"><span class="pre">3*t**2</span> <span class="pre">+</span> <span class="pre">2*t</span></code> (note the list is in <em>ascending</em> order of polynomials).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">alpha_t</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha_s</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">A_x</span></code> is a scalar, <code class="docutils literal notranslate"><span class="pre">alpha_x</span></code> is the exponent for this power law expression. For example, if <code class="docutils literal notranslate"><span class="pre">A_t=2</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha_t=0.5</span></code>, the resulting power law will be <code class="docutils literal notranslate"><span class="pre">2*t**0.5</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B_t</span></code>, <code class="docutils literal notranslate"><span class="pre">B_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Exponential coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">beta_t</span></code>, <code class="docutils literal notranslate"><span class="pre">beta_s</span></code></p></td>
<td><p>Float, default=0</p></td>
<td><p>Exponential scaling factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">C_t</span></code>, <code class="docutils literal notranslate"><span class="pre">C_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>If a scalar is given, this is the coefficient for the natural logarithmic term. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the logarithmic term is set to 1 (i.e. it is ignored).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gamma_t</span></code>, <code class="docutils literal notranslate"><span class="pre">gamma_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Logarithmic scaling factor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">D_t</span></code>, <code class="docutils literal notranslate"><span class="pre">D_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>If a scalar is given, this is the coefficient for the logistic term. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the logistic term is set to 1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta1_t</span></code>, <code class="docutils literal notranslate"><span class="pre">delta1_s</span></code></p></td>
<td><p>Float, default=1</p></td>
<td><p>Logistic growth rate (steepness of the logistic term)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta2_t</span></code>, <code class="docutils literal notranslate"><span class="pre">delta2_s</span></code></p></td>
<td><p>Float or None, default=None</p></td>
<td><p>Midpoint of the logistic curve, which denotes the <code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">s</span></code> value where the logistic curve is at its midpoint. If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the midpoint is assumed to be the at the midpoint of the <code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">s</span></code> range. For example, if the model timesteps go from 1 to 100, then the default for <code class="docutils literal notranslate"><span class="pre">delta2_t</span></code> is 50.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">is_compound</span></code></p></td>
<td><p>Bool, default=True</p></td>
<td><p>Whether the <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> regression terms should be combined by multiplying them together (compound) or adding them. Choice depends on whether you think the time- and size-dependence of rate constants affect each other or act independently.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="warning admonition">
<p class="admonition-title">Negative k values</p>
<p>Make sure to specify regression parameters that do not end up in negative <code class="docutils literal notranslate"><span class="pre">k</span></code> values. The model checks for these before running and will throw a <code class="docutils literal notranslate"><span class="pre">FMNPDistributionValueError</span></code> exception if any are found.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<p>The make this more understandable, here are some examples are how you might use these parameters in real life. The first thing to note is that, if you want a k distribution to follow one particular regression, such as logistic, then you only need to specify parameters for that regression and the defaults take care of making sure the other regressions are constant. Taking a logistic regression as an example for <code class="docutils literal notranslate"><span class="pre">k_frag</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fragmentmnp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FragmentMNP</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fragmentmnp.examples</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span>

<span class="c1"># By specifying D_t=1, we are telling the model that we want a</span>
<span class="c1"># logistic regression over time for k_frag. delta1_t controls</span>
<span class="c1"># the steepness of the logistic</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;D_t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;delta1_t&#39;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>

<span class="c1"># Init the model with these data, which generates the k distributions</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>

<span class="c1"># Plot the k_frag distribution to check that it is logistic. We</span>
<span class="c1"># didn&#39;t specify any surface area dependence params and so we</span>
<span class="c1"># can pick any size class except the smallest (which always </span>
<span class="c1"># has k_frag=0)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9b42843ef7f039daf6e1c809d85e7f7065387b83a73f017c61a17768a58f2e44.png" src="_images/9b42843ef7f039daf6e1c809d85e7f7065387b83a73f017c61a17768a58f2e44.png" />
</div>
</div>
<p>In the above, we effectively specified that <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> should follow the regresion <span class="math notranslate nohighlight">\(k_\text{frag} = 0.01 / (1 + e^{-(\hat{t} - 1)})\)</span>. Let’s now introduce a linear surface area dependence. Because the particle size classes are log-spaced, we plot with a log yscale in order to see the fragmentation rates for the smaller size classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify a logistic regression over t and linear over s</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;D_t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;delta1_t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;A_s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Init the model</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>

<span class="c1"># Plot k_frag for all size classes except the smallest</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s1">&lt;1g</span><span class="si">}</span><span class="s1"> µm&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">psd</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba065357b45eb20b627b4b54e52e8cbd3ebdd031a8a72c6a00c19442f532961f.png" src="_images/ba065357b45eb20b627b4b54e52e8cbd3ebdd031a8a72c6a00c19442f532961f.png" />
</div>
</div>
<p>We can double check that the surface area dependence is linear by plotting the surface area against <code class="docutils literal notranslate"><span class="pre">k_frag</span></code> for one timestep:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">surface_areas</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;particle surface area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4d2cd6d7e3fad326694fff39920affbd5076920ec0349c66562c2a3808a64ef9.png" src="_images/4d2cd6d7e3fad326694fff39920affbd5076920ec0349c66562c2a3808a64ef9.png" />
</div>
</div>
<p>Combining regressions can make for some weird and wonderful distribution shapes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third-order polynomial combined with a logarithmic regression - why not!?</span>
<span class="n">minimal_data</span><span class="p">[</span><span class="s1">&#39;k_frag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;k_f&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;k_0&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;A_t&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;C_t&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="c1"># Create and plot</span>
<span class="n">fmnp</span> <span class="o">=</span> <span class="n">FragmentMNP</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">,</span> <span class="n">minimal_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k_frag&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/672d077563e23bbefa64ccb8b441127b69093c36d20271408da94dec653718c8.png" src="_images/672d077563e23bbefa64ccb8b441127b69093c36d20271408da94dec653718c8.png" />
</div>
</div>
</div>
<div class="section" id="setting-your-own-rate-constant-regressions">
<h2>Setting your own rate constant regressions<a class="headerlink" href="#setting-your-own-rate-constant-regressions" title="Permalink to this heading">#</a></h2>
<p>If the time and size dependencies that can be achieved using the regression parammeters above are not flexible enough for your scenario, you can of course set your own <span class="math notranslate nohighlight">\(k_\text{frag}\)</span>, <span class="math notranslate nohighlight">\(k_\text{diss}\)</span> or <span class="math notranslate nohighlight">\(k_\text{min}\)</span> arrays by modifying the <code class="docutils literal notranslate"><span class="pre">k_frag</span></code>, <code class="docutils literal notranslate"><span class="pre">k_diss</span></code> or <code class="docutils literal notranslate"><span class="pre">k_min</span></code> attributes directly after initialising the model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a random k_frag array (really?!)</span>
<span class="n">fmnp</span><span class="o">.</span><span class="n">k_frag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">fmnp</span><span class="o">.</span><span class="n">n_size_classes</span><span class="p">,</span> <span class="n">fmnp</span><span class="o">.</span><span class="n">n_timesteps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plotting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Plotting</p>
      </div>
    </a>
    <a class="right-next"
       href="dissolution-mineralisation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dissolution and mineralisation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-parameters">Regression parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-your-own-rate-constant-regressions">Setting your own rate constant regressions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By UKCEH
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div style="position: relative">
  <a href="https://www.ceh.ac.uk/privacy-notice" target="_blank">Privacy notice</a>
  <img src="_static/ukceh.png" width=200 style="position: absolute; right: 0; bottom: 0;">
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>